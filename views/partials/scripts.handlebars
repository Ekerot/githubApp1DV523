<script src="https://code.jquery.com/jquery-3.1.1.js"
        integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA="
        crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.8/js/materialize.js"></script>

<script type="text/javascript">$(document).ready(function(){
    $('.collapsible').collapsible();});</script>

<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

<script>
    var socket = io.connect();

    socket.on('webhook', function(hook) {

        var selector = "li[id*='" + hook.issue.id + "']";

        console.log(hook)

        $(document).ready(function () {
            if (hook.action === 'closed') {

                $(selector).remove();
            }


            else if (hook.action === 'created') {

                $(selector).find('.comments').text(hook.issue.comments + ' comments are written');
            }


            else if (hook.action === 'opened' || 'reopened') {
                $('#list-issues').append($('<li>').attr('id', hook.issue.id + ' list-element'));

                $(selector).append($('<div>').attr('class', 'collapsible-header red darken-1 white-text z-depth-5')
                        .append($('<i>').attr('class', 'material-icons').text('whatshot'))
                        .append($('<p>').text(hook.issue.title)));

                $(selector).append($('<div>').attr('class', 'collapsible-body')
                        .append($('<p>').attr('class', 'body').text(hook.issue.body)));

                $(selector).find(".collapsible-body").append($('<p>').attr('id', 'comments')
                        .text(hook.issue.comments + ' comments are written'));

                $(selector).find(".collapsible-body").append($('<p>')
                        .append($('<a>').attr('href', hook.issue.html_url)
                                .text(hook.issue.html_url)));

                $(selector).find(".collapsible-body").append($('<p>')
                        .text('Created at ' + hook.issue.created_at));

                $(selector).find('.collapsible-body').append($('<div>').attr('class', 'chip')
                        .append($('<img>').attr('class', 'round')));

                $(selector).find('.chip').append($('<span>')
                        .attr('class', 'card-title').text(hook.login));
            }
        });
    });
</script>

