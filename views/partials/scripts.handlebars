<script src="https://code.jquery.com/jquery-3.1.1.js"
        integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA="
        crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.8/js/materialize.js"></script>

<script type="text/javascript">$(document).ready(function(){
    $('.collapsible').collapsible();});</script>

<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

<script>
    var socket = io.connect();

    socket.on('webhook', function(hook){

        var selector = "li[id*='"+hook.issue.id+"']";

        if(hook.action === 'closed') {
            $(document).ready(function() {
                $(selector).remove();
            });
        }

        else if(hook.action === 'created'){
            $(document).ready(function() {
            $(selector).find("#comments").text(hook.issue.comments + " comments are written");
        });
        }

        else if(hook.action === 'opened' || 'reopened'){
            $(document).ready(function() {
            $('#list-issues').append($('<li>').attr("id", hook.issue.id + " list-element"));

            $(selector).append($('<div>').attr('class', "collapsible-header red darken-1 white-text z-depth-5")
                    .append($('<i>').attr('class', 'material-icons').text('whatshot')));

            $(selector).find("collapsible-header red darken-1 white-text z-depth-5").append($('<p>').text(hook.issue.title));
        });

        }
    });
</script>

